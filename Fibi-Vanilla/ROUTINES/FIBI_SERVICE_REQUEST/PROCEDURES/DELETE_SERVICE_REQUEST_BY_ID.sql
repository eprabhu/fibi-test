-- `DELETE_SERVICE_REQUEST_BY_ID`; 

CREATE PROCEDURE `DELETE_SERVICE_REQUEST_BY_ID`(AV_SR_HEADER_ID INT)
BEGIN
SET SQL_SAFE_UPDATES= 0 ;
                    DELETE FROM SR_STATUS_HISTORY WHERE SR_HEADER_ID = AV_SR_HEADER_ID;
					
					DELETE FROM SR_PROCESS_FLOW WHERE SR_HEADER_ID = AV_SR_HEADER_ID;
					
					DELETE FROM SR_PERSON_ROLES WHERE SR_HEADER_ID = AV_SR_HEADER_ID;
					
					DELETE FROM SR_ATTACHMENT WHERE SR_HEADER_ID = AV_SR_HEADER_ID;
					
					DELETE FROM SR_COMMENTS WHERE SR_HEADER_ID = AV_SR_HEADER_ID;
                    
					DELETE FROM SR_HEADER_HISTORY WHERE SR_HEADER_ID = AV_SR_HEADER_ID;
					DELETE FROM SR_REPORTER_CHANGE_HISTORY WHERE SR_HEADER_ID = AV_SR_HEADER_ID;
					DELETE FROM SR_ACTION_LOG WHERE SR_HEADER_ID = AV_SR_HEADER_ID;
                    
                    DELETE FROM ASSOC_SR WHERE SR_HEADER_ID = AV_SR_HEADER_ID;
					DELETE FROM SR_PERSON_UNITS WHERE SR_HEADER_ID = AV_SR_HEADER_ID;
                    
                    DELETE FROM SR_PERSONS WHERE SR_HEADER_ID = AV_SR_HEADER_ID;
                    
					DELETE FROM QUEST_ANSWER_ATTACHMENT
					WHERE QUESTIONNAIRE_ANSWER_ID IN(SELECT QUESTIONNAIRE_ANSWER_ID FROM QUEST_ANSWER
												 WHERE QUESTIONNAIRE_ANS_HEADER_ID IN(SELECT QUESTIONNAIRE_ANS_HEADER_ID
																					 FROM QUEST_ANSWER_HEADER
																					 WHERE MODULE_ITEM_CODE = 20
																					 AND MODULE_ITEM_KEY = AV_SR_HEADER_ID));
                    DELETE FROM QUEST_TABLE_ANSWER
				    WHERE QUESTIONNAIRE_ANS_HEADER_ID IN(SELECT QUESTIONNAIRE_ANS_HEADER_ID
													 FROM QUEST_ANSWER_HEADER
													 WHERE MODULE_ITEM_CODE = 20
													 AND MODULE_ITEM_KEY = AV_SR_HEADER_ID);
                    
					DELETE FROM QUEST_ANSWER
					WHERE QUESTIONNAIRE_ANS_HEADER_ID IN(SELECT QUESTIONNAIRE_ANS_HEADER_ID
													 FROM QUEST_ANSWER_HEADER
													 WHERE MODULE_ITEM_CODE = 20
													 AND MODULE_ITEM_KEY = AV_SR_HEADER_ID);
					
					DELETE FROM QUEST_ANSWER_HEADER
					WHERE MODULE_ITEM_CODE = 20
					AND MODULE_ITEM_KEY = AV_SR_HEADER_ID;
                    
                   DELETE FROM SR_MAIL_INFORMATIONS WHERE SR_HEADER_ID = AV_SR_HEADER_ID;
					DELETE FROM SR_HEADER WHERE SR_HEADER_ID = AV_SR_HEADER_ID;
	SET SQL_SAFE_UPDATES= 1;
END

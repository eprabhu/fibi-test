-- `COPY_MERGE_EPS_PROPOSAL_ADDITIONAL_DATA`; 

CREATE PROCEDURE `COPY_MERGE_EPS_PROPOSAL_ADDITIONAL_DATA`(
IN AV_ACTIVE_PROPOSAL_ID  INT,
IN AV_ARCHIVE_PROPOSAL_ID  INT,
IN AV_TYPE VARCHAR(1) 
)
BEGIN
  
    DECLARE LS_SCIENCE_KEYWORD_CODE	varchar(15);
	DECLARE LD_UPDATE_TIMESTAMP	datetime;
	DECLARE LS_UPDATE_USER	varchar(60) ;
	DECLARE LS_KEYWORD	varchar(255);
	DECLARE LS_IS_FOREIGN_ACTIVITIES	varchar(1);
	DECLARE LS_IS_SUBCONTRACT	varchar(1);
	DECLARE LS_IS_MULTISITE_STUDY	varchar(1);
	DECLARE LS_IS_DOMESTIC_SITE	varchar(1);
	DECLARE LI_AMOUNT	decimal(12,2); 
	DECLARE LS_SPONSOR_CODE	varchar(20);  
	DECLARE LI_FUNDING_STATUS_CODE	int;
	DECLARE LS_SPONSOR_NAME	varchar(255);
	DECLARE LS_SPONSOR_TYPE_CODE	varchar(255);
	DECLARE LS_CURRENCY_CODE	varchar(255);
	DECLARE LS_GRANT_CALL_NAME	varchar(255);
	DECLARE LI_PERCENTAGE_OF_EFFORT	decimal(19,2);
	DECLARE LI_PROP_PERSON_ROLE_ID	int;
	DECLARE LS_PROJECT_TITLE	varchar(1000);
	DECLARE LD_APPLICATION_DATE	datetime;
	DECLARE LD_APPROVAL_DATE	datetime;
	DECLARE LS_APPROVAL_TYPE_CODE	varchar(3);
	DECLARE LS_COMMENTS	longtext;
	DECLARE LD_EXPIRATION_DATE	datetime;
	DECLARE LS_PROTOCOL_NUMBER	varchar(30);
	DECLARE LS_PROTOCOL_STATUS_DESCRIPTION	varchar(200);
	DECLARE LS_SPECIAL_REVIEW_CODE	varchar(3); 
	DECLARE LS_IS_INTEGRATED_PROTOCOL	varchar(1);
	DECLARE LI_EXCELLENCE_AREA_CODE	int;
	DECLARE LS_RESEARCH_AREA_CODE	varchar(3);
	DECLARE LS_RESRCH_TYPE_CODE	varchar(3); 
	DECLARE LS_RESRCH_TYPE_AREA_CODE	varchar(255);
	DECLARE LS_RESRCH_TYPE_SUB_AREA_CODE	varchar(255);
	DECLARE LS_RESEARCH_SUB_AREA_CODE	varchar(255);
	DECLARE LS_CHALLENGE_AREA_CODE	varchar(255);
	DECLARE LS_CHALLENGE_SUBAREA_CODE	varchar(255);
	DECLARE LI_RESEARCH_RANK	int;
	DECLARE LS_PERSON_ID	varchar(40);
	DECLARE LS_FULL_NAME	varchar(255);
	DECLARE LS_PROJECT_ROLE	varchar(100);
	DECLARE LS_NON_EMPLOYEE_FLAG	varchar(1);
	DECLARE LI_PERCENTAGE_CHARGED	decimal(5,2);
	DECLARE LD_START_DATE	datetime;
	DECLARE LD_END_DATE	datetime;
	DECLARE LS_IS_ACTIVE	varchar(1); 
	DECLARE LS_DESIGNATION	varchar(60);
	DECLARE LI_IRB_PROTOCOL_ID	int;
	DECLARE LI_PROTOCOL_ID	decimal(12,0); 
	
	DECLARE LS_ERROR_MSG	              VARCHAR(2000);
	DECLARE LS_ERROR_FLAG	              VARCHAR(1) DEFAULT 'N';
    DECLARE NOT_FOUND                 INT;
    DECLARE LS_PROC_LOC                VARCHAR(200);
    DECLARE li_seq_proposal_id          INT;
	
	DECLARE  SEL_EPS_PROPOSAL_KEYWORDS CURSOR FOR
    SELECT SCIENCE_KEYWORD_CODE, UPDATE_TIMESTAMP, UPDATE_USER, KEYWORD FROM EPS_PROPOSAL_KEYWORDS WHERE PROPOSAL_ID = li_seq_proposal_id ;
	
	DECLARE  SEL_EPS_PROPOSAL_EXT CURSOR FOR
    SELECT IS_FOREIGN_ACTIVITIES, IS_SUBCONTRACT, IS_MULTISITE_STUDY, IS_DOMESTIC_SITE FROM EPS_PROPOSAL_EXT  WHERE PROPOSAL_ID = li_seq_proposal_id ;
 
	DECLARE  SEL_EPS_PROPOSAL_SPONSORS CURSOR FOR
	SELECT  AMOUNT, END_DATE, SPONSOR_CODE, START_DATE, UPDATE_TIMESTAMP,
	UPDATE_USER, FULL_NAME, FUNDING_STATUS_CODE, SPONSOR_NAME, SPONSOR_TYPE_CODE, 
	CURRENCY_CODE, GRANT_CALL_NAME, PERCENTAGE_OF_EFFORT, PROP_PERSON_ROLE_ID, PROJECT_TITLE FROM EPS_PROPOSAL_SPONSORS  WHERE PROPOSAL_ID = li_seq_proposal_id ;
	
	DECLARE  SEL_EPS_PROPOSAL_SPECIAL_REVIEW CURSOR FOR
	SELECT  APPLICATION_DATE, APPROVAL_DATE, APPROVAL_TYPE_CODE, COMMENTS, 
	EXPIRATION_DATE, PROTOCOL_NUMBER, PROTOCOL_STATUS_DESCRIPTION, SPECIAL_REVIEW_CODE,
	UPDATE_TIMESTAMP, UPDATE_USER,IS_INTEGRATED_PROTOCOL FROM EPS_PROPOSAL_SPECIAL_REVIEW  WHERE PROPOSAL_ID = li_seq_proposal_id ;	
	
	DECLARE  SEL_EPS_PROPOSAL_RESRCH_AREAS CURSOR FOR
	SELECT   EXCELLENCE_AREA_CODE, RESEARCH_AREA_CODE, RESRCH_TYPE_CODE, UPDATE_TIMESTAMP, 
	UPDATE_USER,  RESRCH_TYPE_AREA_CODE, RESRCH_TYPE_SUB_AREA_CODE, RESEARCH_SUB_AREA_CODE, 
	CHALLENGE_AREA_CODE, CHALLENGE_SUBAREA_CODE, RESEARCH_RANK FROM EPS_PROPOSAL_RESRCH_AREAS  WHERE PROPOSAL_ID = li_seq_proposal_id ;	
	
	DECLARE  SEL_EPS_PROPOSAL_PROJECT_TEAM CURSOR FOR
	SELECT  PERSON_ID, FULL_NAME, PROJECT_ROLE, NON_EMPLOYEE_FLAG, PERCENTAGE_CHARGED,
	START_DATE, END_DATE, IS_ACTIVE, UPDATE_TIMESTAMP, UPDATE_USER, DESIGNATION FROM EPS_PROPOSAL_PROJECT_TEAM  WHERE PROPOSAL_ID = li_seq_proposal_id ;
	
	DECLARE  SEL_EPS_PROPOSAL_IRB_PROTOCOL CURSOR FOR
    SELECT IRB_PROTOCOL_ID, PROTOCOL_ID, UPDATE_TIMESTAMP, UPDATE_USER  FROM EPS_PROPOSAL_IRB_PROTOCOL  WHERE PROPOSAL_ID = li_seq_proposal_id ;	
	
	DECLARE EXIT HANDLER FOR SQLEXCEPTION
				BEGIN
				
					GET DIAGNOSTICS CONDITION 1 @sqlstate = RETURNED_SQLSTATE, 
					 @errno = MYSQL_ERRNO, @msg = MESSAGE_TEXT;					 
					SET @full_error = CONCAT(@msg,'/',LS_PROC_LOC);	
					SET LS_ERROR_MSG = @full_error;
                  RESIGNAL SET MESSAGE_TEXT = LS_ERROR_MSG;			
		 
                END;
				
     DECLARE CONTINUE HANDLER FOR NOT FOUND SET NOT_FOUND = 1;	
 
	 SET LS_ERROR_FLAG = 'N';
     
	  
	 IF AV_TYPE = 'M' THEN 
	
   SET LS_PROC_LOC = 'DELETE_EPS_PROPOSAL_KEYWORDS';
     SET li_seq_proposal_id = AV_ARCHIVE_PROPOSAL_ID;
     SET SQL_SAFE_UPDATES = 0;
	 
	 DELETE FROM EPS_PROPOSAL_KEYWORDS WHERE PROPOSAL_ID = AV_ACTIVE_PROPOSAL_ID ;
	 DELETE FROM EPS_PROPOSAL_EXT  WHERE PROPOSAL_ID = AV_ACTIVE_PROPOSAL_ID ;
	 
	 DELETE FROM EPS_PROPOSAL_SPONSORS  WHERE PROPOSAL_ID = AV_ACTIVE_PROPOSAL_ID ;
	 
	 DELETE FROM EPS_PROPOSAL_SPECIAL_REVIEW  WHERE PROPOSAL_ID = AV_ACTIVE_PROPOSAL_ID ;
	 
	 DELETE FROM EPS_PROPOSAL_RESRCH_AREAS  WHERE PROPOSAL_ID = AV_ACTIVE_PROPOSAL_ID ;	
	 
	 DELETE FROM EPS_PROPOSAL_PROJECT_TEAM  WHERE PROPOSAL_ID = AV_ACTIVE_PROPOSAL_ID ;
	 
	 DELETE FROM   EPS_PROPOSAL_IRB_PROTOCOL  WHERE PROPOSAL_ID = AV_ACTIVE_PROPOSAL_ID ;
	 
	 SET SQL_SAFE_UPDATES = 1;
	 
	 ELSEIF AV_TYPE = 'C' THEN 
	 
	 SET li_seq_proposal_id = AV_ACTIVE_PROPOSAL_ID;
	 
	 END IF;
	 
	 
	  
  SET LS_PROC_LOC = 'EPS_PROPOSAL_KEYWORDS';
			
            OPEN SEL_EPS_PROPOSAL_KEYWORDS;
            SEL_EPS_PROPOSAL_KEYWORDS:LOOP
			SET NOT_FOUND  = 0;
            FETCH SEL_EPS_PROPOSAL_KEYWORDS INTO LS_SCIENCE_KEYWORD_CODE,LD_UPDATE_TIMESTAMP,LS_UPDATE_USER,LS_KEYWORD;
 
			
            IF NOT_FOUND=1 THEN
            LEAVE SEL_EPS_PROPOSAL_KEYWORDS;
            END IF;
            
               
                INSERT INTO EPS_PROPOSAL_KEYWORDS	
                (
				 SCIENCE_KEYWORD_CODE,
				 UPDATE_TIMESTAMP,
				 UPDATE_USER,
				 PROPOSAL_ID,
				 KEYWORD )
					VALUES(
				   LS_SCIENCE_KEYWORD_CODE,
				   LD_UPDATE_TIMESTAMP,
				   LS_UPDATE_USER,
				   CASE WHEN AV_TYPE = 'M' THEN AV_ACTIVE_PROPOSAL_ID WHEN AV_TYPE = 'C' THEN AV_ARCHIVE_PROPOSAL_ID END,
				   LS_KEYWORD
                );
                
              
		END LOOP SEL_EPS_PROPOSAL_KEYWORDS;
		CLOSE SEL_EPS_PROPOSAL_KEYWORDS;  
		
		
	
    SET LS_PROC_LOC = 'EPS_PROPOSAL_EXT';
			
            OPEN SEL_EPS_PROPOSAL_EXT;
            SEL_EPS_PROPOSAL_EXT:LOOP
			SET NOT_FOUND  = 0;
            FETCH SEL_EPS_PROPOSAL_EXT INTO LS_IS_FOREIGN_ACTIVITIES,LS_IS_SUBCONTRACT,LS_IS_MULTISITE_STUDY,LS_IS_DOMESTIC_SITE;
 
			
            IF NOT_FOUND=1 THEN
            LEAVE SEL_EPS_PROPOSAL_EXT;
            END IF;
            
               
                INSERT INTO EPS_PROPOSAL_EXT	
                (
				 PROPOSAL_ID,
				 IS_FOREIGN_ACTIVITIES,
				 IS_SUBCONTRACT,
				 IS_MULTISITE_STUDY,
				 IS_DOMESTIC_SITE )
					VALUES(
					CASE WHEN AV_TYPE = 'M' THEN AV_ACTIVE_PROPOSAL_ID WHEN AV_TYPE = 'C' THEN AV_ARCHIVE_PROPOSAL_ID END,
				   LS_IS_FOREIGN_ACTIVITIES,
				   LS_IS_SUBCONTRACT,
				   LS_IS_MULTISITE_STUDY,
				   LS_IS_DOMESTIC_SITE
                );
                
              
		END LOOP SEL_EPS_PROPOSAL_EXT;
		CLOSE SEL_EPS_PROPOSAL_EXT;  
		
		
		
	 SET LS_PROC_LOC = 'EPS_PROPOSAL_SPONSORS';
			
            OPEN SEL_EPS_PROPOSAL_SPONSORS;
            SEL_EPS_PROPOSAL_SPONSORS:LOOP
			SET NOT_FOUND  = 0;
            FETCH SEL_EPS_PROPOSAL_SPONSORS INTO LI_AMOUNT ,LD_END_DATE ,LS_SPONSOR_CODE	 ,LD_START_DATE ,LD_UPDATE_TIMESTAMP ,LS_UPDATE_USER ,LS_FULL_NAME ,LI_FUNDING_STATUS_CODE ,
                  LS_SPONSOR_NAME,LS_SPONSOR_TYPE_CODE,LS_CURRENCY_CODE,LS_GRANT_CALL_NAME,LI_PERCENTAGE_OF_EFFORT,LI_PROP_PERSON_ROLE_ID,LS_PROJECT_TITLE;
 
			
            IF NOT_FOUND=1 THEN
            LEAVE SEL_EPS_PROPOSAL_SPONSORS;
            END IF;
            
               
                INSERT INTO EPS_PROPOSAL_SPONSORS	
                (
				 AMOUNT,
				 END_DATE,
				 SPONSOR_CODE,
				 START_DATE,
				 UPDATE_TIMESTAMP,
				 UPDATE_USER,
				 PROPOSAL_ID,
				 FULL_NAME,
				 FUNDING_STATUS_CODE,
				 SPONSOR_NAME,
				 SPONSOR_TYPE_CODE,
				 CURRENCY_CODE,
				 GRANT_CALL_NAME,
				 PERCENTAGE_OF_EFFORT,
				 PROP_PERSON_ROLE_ID,
				 PROJECT_TITLE )
					VALUES(
					LI_AMOUNT,
					LD_END_DATE,
					LS_SPONSOR_CODE,
					LD_START_DATE,
					LD_UPDATE_TIMESTAMP,
					LS_UPDATE_USER,
					CASE WHEN AV_TYPE = 'M' THEN AV_ACTIVE_PROPOSAL_ID WHEN AV_TYPE = 'C' THEN AV_ARCHIVE_PROPOSAL_ID END,
					LS_FULL_NAME,
					LI_FUNDING_STATUS_CODE,
					LS_SPONSOR_NAME,
					LS_SPONSOR_TYPE_CODE,
					LS_CURRENCY_CODE,
					LS_GRANT_CALL_NAME,
					LI_PERCENTAGE_OF_EFFORT,
					LI_PROP_PERSON_ROLE_ID,
					LS_PROJECT_TITLE
                );
                
              
		END LOOP SEL_EPS_PROPOSAL_SPONSORS;
		CLOSE SEL_EPS_PROPOSAL_SPONSORS;  
   
      
    SET LS_PROC_LOC = 'EPS_PROPOSAL_SPECIAL_REVIEW';
			
            OPEN SEL_EPS_PROPOSAL_SPECIAL_REVIEW;
            SEL_EPS_PROPOSAL_SPECIAL_REVIEW:LOOP
			SET NOT_FOUND  = 0;
              
            FETCH SEL_EPS_PROPOSAL_SPECIAL_REVIEW INTO LD_APPLICATION_DATE,LD_APPROVAL_DATE,LS_APPROVAL_TYPE_CODE,LS_COMMENTS,LD_EXPIRATION_DATE,LS_PROTOCOL_NUMBER,LS_PROTOCOL_STATUS_DESCRIPTION,LS_SPECIAL_REVIEW_CODE,LD_UPDATE_TIMESTAMP,LS_UPDATE_USER,LS_IS_INTEGRATED_PROTOCOL;
               
			
            IF NOT_FOUND=1 THEN
            LEAVE SEL_EPS_PROPOSAL_SPECIAL_REVIEW;
            END IF;
            
               
                INSERT INTO EPS_PROPOSAL_SPECIAL_REVIEW	
                (
				 APPLICATION_DATE,
				 APPROVAL_DATE,
				 APPROVAL_TYPE_CODE,
				 COMMENTS,
				 EXPIRATION_DATE,
				 PROTOCOL_NUMBER,
				 PROTOCOL_STATUS_DESCRIPTION,
				 SPECIAL_REVIEW_CODE,
				 UPDATE_TIMESTAMP,
				 UPDATE_USER,
				 PROPOSAL_ID,
				 IS_INTEGRATED_PROTOCOL )
					VALUES(
					LD_APPLICATION_DATE,
					LD_APPROVAL_DATE,
					LS_APPROVAL_TYPE_CODE,
					LS_COMMENTS,
					LD_EXPIRATION_DATE,
					LS_PROTOCOL_NUMBER,
					LS_PROTOCOL_STATUS_DESCRIPTION,
					LS_SPECIAL_REVIEW_CODE,
					LD_UPDATE_TIMESTAMP,
					LS_UPDATE_USER,
					CASE WHEN AV_TYPE = 'M' THEN AV_ACTIVE_PROPOSAL_ID WHEN AV_TYPE = 'C' THEN AV_ARCHIVE_PROPOSAL_ID END,
					LS_IS_INTEGRATED_PROTOCOL
                );
                
              
		END LOOP SEL_EPS_PROPOSAL_SPECIAL_REVIEW;
		CLOSE SEL_EPS_PROPOSAL_SPECIAL_REVIEW;  
		
SET LS_PROC_LOC = 'EPS_PROPOSAL_RESRCH_AREAS';
			
            OPEN SEL_EPS_PROPOSAL_RESRCH_AREAS ;
            SEL_EPS_PROPOSAL_RESRCH_AREAS:LOOP
			SET NOT_FOUND  = 0;
            FETCH SEL_EPS_PROPOSAL_RESRCH_AREAS INTO LI_EXCELLENCE_AREA_CODE,LS_RESEARCH_AREA_CODE,LS_RESRCH_TYPE_CODE,LD_UPDATE_TIMESTAMP,LS_UPDATE_USER,LS_RESRCH_TYPE_AREA_CODE,LS_RESRCH_TYPE_SUB_AREA_CODE,LS_RESEARCH_SUB_AREA_CODE,LS_CHALLENGE_AREA_CODE,LS_CHALLENGE_SUBAREA_CODE,LI_RESEARCH_RANK;
 
			
            IF NOT_FOUND=1 THEN
            LEAVE SEL_EPS_PROPOSAL_RESRCH_AREAS;
            END IF;
            
               
                INSERT INTO EPS_PROPOSAL_RESRCH_AREAS	
                (
				EXCELLENCE_AREA_CODE,
				RESEARCH_AREA_CODE,
				RESRCH_TYPE_CODE,
				UPDATE_TIMESTAMP,
				UPDATE_USER,
				PROPOSAL_ID,
				RESRCH_TYPE_AREA_CODE,
				RESRCH_TYPE_SUB_AREA_CODE,
				RESEARCH_SUB_AREA_CODE,
				CHALLENGE_AREA_CODE,
				CHALLENGE_SUBAREA_CODE,
				RESEARCH_RANK )
					VALUES(
					LI_EXCELLENCE_AREA_CODE,
					LS_RESEARCH_AREA_CODE,
					LS_RESRCH_TYPE_CODE,
					LD_UPDATE_TIMESTAMP,
					LS_UPDATE_USER,
					CASE WHEN AV_TYPE = 'M' THEN AV_ACTIVE_PROPOSAL_ID WHEN AV_TYPE = 'C' THEN AV_ARCHIVE_PROPOSAL_ID END,
					LS_RESRCH_TYPE_AREA_CODE,
					LS_RESRCH_TYPE_SUB_AREA_CODE,
					LS_RESEARCH_SUB_AREA_CODE,
					LS_CHALLENGE_AREA_CODE,
					LS_CHALLENGE_SUBAREA_CODE,
					LI_RESEARCH_RANK
                );
                
              
		END LOOP SEL_EPS_PROPOSAL_RESRCH_AREAS;
		CLOSE SEL_EPS_PROPOSAL_RESRCH_AREAS;  
		
		
SET LS_PROC_LOC = 'EPS_PROPOSAL_PROJECT_TEAM';
			
            OPEN SEL_EPS_PROPOSAL_PROJECT_TEAM;
            SEL_EPS_PROPOSAL_PROJECT_TEAM:LOOP
			SET NOT_FOUND  = 0;
            FETCH SEL_EPS_PROPOSAL_PROJECT_TEAM INTO LS_PERSON_ID,LS_FULL_NAME,LS_PROJECT_ROLE,LS_NON_EMPLOYEE_FLAG,LI_PERCENTAGE_CHARGED,LD_START_DATE,LD_END_DATE,LS_IS_ACTIVE,LD_UPDATE_TIMESTAMP,LS_UPDATE_USER,LS_DESIGNATION;
 
			
            IF NOT_FOUND=1 THEN
            LEAVE SEL_EPS_PROPOSAL_PROJECT_TEAM;
            END IF;
            
               
                INSERT INTO EPS_PROPOSAL_PROJECT_TEAM	
                (
					PROPOSAL_ID,
					PERSON_ID,
					FULL_NAME,
					PROJECT_ROLE,
					NON_EMPLOYEE_FLAG,
					PERCENTAGE_CHARGED,
					START_DATE,
					END_DATE,
					IS_ACTIVE,
					UPDATE_TIMESTAMP,
					UPDATE_USER,
					DESIGNATION )
					VALUES(
					CASE WHEN AV_TYPE = 'M' THEN AV_ACTIVE_PROPOSAL_ID WHEN AV_TYPE = 'C' THEN AV_ARCHIVE_PROPOSAL_ID END,
					LS_PERSON_ID,
					LS_FULL_NAME,
					LS_PROJECT_ROLE,
					LS_NON_EMPLOYEE_FLAG,
					LI_PERCENTAGE_CHARGED,
					LD_START_DATE,
					LD_END_DATE,
					LS_IS_ACTIVE,
					LD_UPDATE_TIMESTAMP,
					LS_UPDATE_USER,
					LS_DESIGNATION
                );
                
              
		END LOOP SEL_EPS_PROPOSAL_PROJECT_TEAM;
		CLOSE SEL_EPS_PROPOSAL_PROJECT_TEAM;  
		
		
 SET LS_PROC_LOC = 'EPS_PROPOSAL_IRB_PROTOCOL';
			
            OPEN SEL_EPS_PROPOSAL_IRB_PROTOCOL;
            SEL_EPS_PROPOSAL_IRB_PROTOCOL:LOOP
			SET NOT_FOUND  = 0;
            FETCH SEL_EPS_PROPOSAL_IRB_PROTOCOL INTO LI_IRB_PROTOCOL_ID,LI_PROTOCOL_ID,LD_UPDATE_TIMESTAMP,LS_UPDATE_USER;
 
			
            IF NOT_FOUND=1 THEN
            LEAVE SEL_EPS_PROPOSAL_IRB_PROTOCOL;
            END IF;
            
               
                INSERT INTO EPS_PROPOSAL_IRB_PROTOCOL	
                (
					IRB_PROTOCOL_ID,
					PROTOCOL_ID,
					UPDATE_TIMESTAMP,
					UPDATE_USER,
					PROPOSAL_ID )
					VALUES(
					
					LI_IRB_PROTOCOL_ID,
					LI_PROTOCOL_ID,
					LD_UPDATE_TIMESTAMP,
					LS_UPDATE_USER,
					CASE WHEN AV_TYPE = 'M' THEN AV_ACTIVE_PROPOSAL_ID WHEN AV_TYPE = 'C' THEN AV_ARCHIVE_PROPOSAL_ID END
                );
                
              
		END LOOP SEL_EPS_PROPOSAL_IRB_PROTOCOL;
		CLOSE SEL_EPS_PROPOSAL_IRB_PROTOCOL;
        
        
 
END

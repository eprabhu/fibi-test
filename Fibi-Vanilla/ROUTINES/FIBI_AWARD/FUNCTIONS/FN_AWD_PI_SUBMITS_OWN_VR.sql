CREATE FUNCTION `FN_AWD_PI_SUBMITS_OWN_VR`(
AV_AWARD_ID     VARCHAR(22),
AV_PERSON_ID    VARCHAR(40)
) RETURNS varchar(6)
    DETERMINISTIC
BEGIN


DECLARE LI_COUNT INT(3);
DECLARE LS_AWARD_ID VARCHAR(22);


        SELECT COUNT(*) INTO LI_COUNT
        FROM AWARD
        WHERE AWARD_ID = AV_AWARD_ID
        AND AWARD_DOCUMENT_TYPE_CODE = 3;


        IF LI_COUNT = 0 THEN
                RETURN 'TRUE';
        END IF;

        SELECT count(*) INTO LI_COUNT
        FROM AWARD A
        WHERE A.AWARD_ID = AV_AWARD_ID
        AND A.AWARD_VARIATION_TYPE_CODE = 12;

        IF LI_COUNT > 0 THEN
                RETURN 'TRUE';
        END IF;

		SELECT count(*) INTO LI_COUNT
        FROM AWARD P
        WHERE P.AWARD_ID = AV_AWARD_ID
        AND P.AWARD_VARIATION_TYPE_CODE IN (1,2,3,4,5,9,10,11,13,15,17,18,19,20)
        AND EXISTS (SELECT 1 FROM AWARD_PERSONS WHERE AWARD_ID = AV_AWARD_ID AND PERSON_ID = AV_PERSON_ID AND PI_FLAG = 'Y');


        IF LI_COUNT = 0 THEN
                RETURN 'FALSE';
        ELSE
                RETURN 'TRUE';
        END IF;


END

INSERT INTO REPORT_TYPE_JOIN (`TYPE_JOIN_ID`,`TYPE_CODE`,`JOIN_QUERY`,`UPDATE_TIMESTAMP`,`UPDATE_USER`) VALUES (5,'13','INNER JOIN (\n  SELECT \n 	A1.AWARD_ID,\n 	A1.AWARD_NUMBER,\n 	A1.ACCOUNT_NUMBER,\n 	T3.BUDGET_CATEGORY_CODE,\n 	A3.DESCRIPTION AS BUDGET_CATEGORY,\n	A4.DESCRIPTION AS COST_ELEMENT,\n 	T3.INTERNAL_ORDER_CODE AS IO_CODE,\n 	IFNULL(S2.EXP_TO_DATE_BY_BUDGT_CATGRY,0) AS EXPENDITURE_TO_DATE,\n 	IFNULL(S5.COMMITTED_AMT_BY_BUDGT_CATGRY,0) AS COMMITTED_AMOUNT,\n	0 AS TOTAL_REVENUE_AMOUNT,\n 	IFNULL(S6.ORIGINAL_APPROVED_BUDGET,0) AS ORIGINAL_AMOUNT,\n 	IFNULL(S7.LATEST_APPROVED_BUDGET,0) AS REVISED_AMOUNT,\n 	IFNULL(S7.LATEST_APPROVED_BUDGET,0)-IFNULL(S2.EXP_TO_DATE_BY_BUDGT_CATGRY,0) AS BALANCE,   \n	IFNULL(S7.LATEST_APPROVED_BUDGET,0)-(IFNULL(S2.EXP_TO_DATE_BY_BUDGT_CATGRY,0)+IFNULL(S5.COMMITTED_AMT_BY_BUDGT_CATGRY,0)) AS BALANCELESS_COMMITTED_AMOUNT,\n 	IFNULL(ROUND((S2.EXP_TO_DATE_BY_BUDGT_CATGRY/S7.LATEST_APPROVED_BUDGET)*100,2),0) AS UTILIZATION_RATE,\n 	NULL AS FM_POSTING_DATE\n FROM AWARD A1 \n INNER JOIN AWARD_BUDGET_HEADER T1 ON A1.AWARD_ID = T1.AWARD_ID\n INNER JOIN AWARD_BUDGET_DETAIL T3 ON T3.BUDGET_HEADER_ID = T1.BUDGET_HEADER_ID\n INNER JOIN BUDGET_CATEGORY A3 ON T3.BUDGET_CATEGORY_CODE = A3.BUDGET_CATEGORY_CODE\n LEFT OUTER JOIN(SELECT\n 				 CHILD.AWARD_NUMBER,\n 				 SUBSTR(CHILD.INTERNAL_ORDER_CODE,16,3) AS BUDGET_CATEGORY_CODE,\n 				 SUM(CHILD.AMOUNT_IN_FMA_CURRENCY) AS EXP_TO_DATE_BY_BUDGT_CATGRY\n 				 FROM AWARD_EXPENSE_TRANSACTIONS CHILD\n 				 WHERE CHILD.ACCOUNT_NUMBER IN(SELECT ACCOUNT_NUMBER FROM AWARD WHERE AWARD_SEQUENCE_STATUS = \'ACTIVE\') \n 				 <FILTER_CONDITION>\n				 AND CHILD.ACTUAL_OR_COMMITTED_FLAG = \'A\'\n 				 GROUP BY CHILD.AWARD_NUMBER,SUBSTR(CHILD.INTERNAL_ORDER_CODE,16,3) \n 				)S2 ON A1.AWARD_NUMBER = S2.AWARD_NUMBER AND T3.BUDGET_CATEGORY_CODE = S2.BUDGET_CATEGORY_CODE\n LEFT OUTER JOIN(SELECT\n 				 CHILD.AWARD_NUMBER,\n 				 SUBSTR(CHILD.INTERNAL_ORDER_CODE,16,3) AS BUDGET_CATEGORY_CODE,\n 				 SUM(CHILD.AMOUNT_IN_FMA_CURRENCY) AS COMMITTED_AMT_BY_BUDGT_CATGRY\n 				 FROM AWARD_EXPENSE_TRANSACTIONS CHILD\n 				 WHERE CHILD.ACCOUNT_NUMBER IN(SELECT ACCOUNT_NUMBER FROM AWARD WHERE AWARD_SEQUENCE_STATUS = \'ACTIVE\') \n 				 <FILTER_CONDITION>\n				 AND CHILD.ACTUAL_OR_COMMITTED_FLAG = \'C\'\n 				 GROUP BY CHILD.AWARD_NUMBER,SUBSTR(CHILD.INTERNAL_ORDER_CODE,16,3) \n 				)S5 ON A1.AWARD_NUMBER = S5.AWARD_NUMBER AND T3.BUDGET_CATEGORY_CODE = S5.BUDGET_CATEGORY_CODE\n \nLEFT OUTER JOIN AWARD_ORG_APPROVED_BUDGET_RT S6 ON A1.AWARD_NUMBER = S6.AWARD_NUMBER \nAND T3.BUDGET_CATEGORY_CODE = S6.BUDGET_CATEGORY_CODE\n\nLEFT OUTER JOIN AWARD_LATEST_APROVED_BUDGET_RT S7 ON A1.AWARD_NUMBER = S7.AWARD_NUMBER \n												  AND T3.BUDGET_CATEGORY_CODE = S7.BUDGET_CATEGORY_CODE	\n INNER JOIN COST_ELEMENT A4 ON T3.COST_ELEMENT = A4.COST_ELEMENT\n												  \n WHERE A1.AWARD_SEQUENCE_STATUS = \'ACTIVE\'\n AND T1.SEQUENCE_NUMBER IN (SELECT MAX(AB1.SEQUENCE_NUMBER) FROM AWARD_BUDGET_HEADER AB1\n 						   WHERE AB1.AWARD_ID = T1.AWARD_ID)\n UNION\n  SELECT \n 	A1.AWARD_ID,\n 	A1.AWARD_NUMBER,\n 	A1.ACCOUNT_NUMBER,\n	\'GRT\' as BUDGET_CATEGORY_CODE,\n 	\'Grant Revenue\' AS BUDGET_CATEGORY,\n	null as COST_ELEMENT,\n 	S2.INTERNAL_ORDER_CODE AS IO_CODE,\n 	0 AS EXPENDITURE_TO_DATE,\n 	0 AS COMMITTED_AMOUNT,\n	IFNULL(S2.REVENUE_BY_BUDGT_CATGRY,0) AS TOTAL_REVENUE_AMOUNT,\n 	0 AS ORIGINAL_AMOUNT,\n 	0 AS REVISED_AMOUNT,\n 	0 AS BALANCE,   \n	0 AS BALANCELESS_COMMITTED_AMOUNT,\n 	0 AS UTILIZATION_RATE,\n 	NULL AS FM_POSTING_DATE\n FROM AWARD A1 \n INNER JOIN(SELECT\n 				 CHILD.AWARD_NUMBER,\n				 CHILD.INTERNAL_ORDER_CODE,\n 				 SUBSTR(CHILD.INTERNAL_ORDER_CODE,16,3) AS BUDGET_CATEGORY_CODE,\n 				 SUM(CHILD.AMOUNT_IN_FMA_CURRENCY) AS REVENUE_BY_BUDGT_CATGRY\n 				 FROM AWARD_REVENUE_TRANSACTIONS CHILD\n 				 WHERE CHILD.ACCOUNT_NUMBER IN(SELECT ACCOUNT_NUMBER FROM AWARD WHERE AWARD_SEQUENCE_STATUS = \'ACTIVE\') \n 				 <FILTER_CONDITION>\n				 AND CHILD.ACTUAL_OR_COMMITTED_FLAG = \'R\'\n 				 GROUP BY CHILD.AWARD_NUMBER,SUBSTR(CHILD.INTERNAL_ORDER_CODE,16,3) \n 				)S2 ON A1.AWARD_NUMBER = S2.AWARD_NUMBER\n WHERE A1.AWARD_SEQUENCE_STATUS = \'ACTIVE\'\n )CHILD ON MASTER_DATA.AWARD_ID = CHILD.AWARD_ID AND MASTER_DATA.PERSON_ROLE_ID = 3','2020-08-24 11:23:36','admin');
INSERT INTO REPORT_TYPE_JOIN (`TYPE_JOIN_ID`,`TYPE_CODE`,`JOIN_QUERY`,`UPDATE_TIMESTAMP`,`UPDATE_USER`) VALUES (6,'14','LEFT join (\n   SELECT SUM(bh.TOTAL_COST) AS `TOTAL_REQUESTED_FUND_AED`, IFNULL(COUNT(distinct `ep`.`PROPOSAL_ID`), 0) AS `NUMBER_OF_PROPOSALS`, \n   `ep`.`GRANT_HEADER_ID`, gch.NAME as GRANT_CALL_TITLE, \n   t4.DESCRIPTION as GRANT_CALL_TYPE,ep.SPONSOR_CODE, \n   ROUND((SUM(`bh`.`TOTAL_COST`) / `rate`.`CURRENCY_RATE`),  0) AS `TOTAL_REQUESTED_COST_USD` FROM `eps_proposal` `ep`\n   LEFT JOIN `eps_proposal_status` `t8` ON `t8`.`STATUS_CODE` = `ep`.`STATUS_CODE` \n   LEFT JOIN `proposal_admin_details` `t5` ON `ep`.`PROPOSAL_ID` = `t5`.`DEV_PROPOSAL_ID`\n   LEFT JOIN `proposal` `t6` ON `t6`.`PROPOSAL_ID` = `t5`.`INST_PROPOSAL_ID` AND `t6`.`PROPOSAL_SEQUENCE_STATUS` = \'ACTIVE\'\n   LEFT JOIN `proposal_status` `t7` ON `t6`.`STATUS_CODE` = `t7`.`STATUS_CODE`\n   LEFT JOIN `grant_call_type` `t4` ON `ep`.`GRANT_TYPE_CODE` = `t4`.`GRANT_TYPE_CODE`\n   LEFT JOIN `budget_header` `bh` ON `ep`.`PROPOSAL_ID` = `bh`.`PROPOSAL_ID` AND (`bh`.`IS_FINAL_BUDGET` = \'Y\' OR `bh`.`IS_LATEST_VERSION` = \'Y\')\n   LEFT JOIN `currency_rate` `rate` ON `rate`.`COUNTRY_CODE` = \'USA\'\n   LEFT JOIN `grant_call_header` `gch` ON `gch`.`GRANT_HEADER_ID` = `ep`.`GRANT_HEADER_ID`\n   WHERE (`ep`.`DOCUMENT_STATUS_CODE` <> 3 OR `ep`.`DOCUMENT_STATUS_CODE` IS NULL) \n   <FILTER_CONDITION>\n   group by ep.SPONSOR_CODE, ep.GRANT_HEADER_ID\n   ) CHILD ON CHILD.SPONSOR_CODE = MASTER_DATA.SPONSOR_CODE','2020-08-24 11:24:37','admin');
INSERT INTO REPORT_TYPE_JOIN (`TYPE_JOIN_ID`,`TYPE_CODE`,`JOIN_QUERY`,`UPDATE_TIMESTAMP`,`UPDATE_USER`) VALUES (18,'49','INNER JOIN(SELECT DISTINCT AWARD_ID, AWARD_NUMBER, BUDGET_CATEGORY_CODE,SUM(PERIOD_1)  AS PERIOD_1,SUM(PERIOD_2)  AS PERIOD_2,SUM(PERIOD_3)  AS PERIOD_3, SUM(PERIOD_4)  AS PERIOD_4, SUM(PERIOD_5)  AS PERIOD_5, SUM(PERIOD_6)  AS PERIOD_6, SUM(PERIOD_7)  AS PERIOD_7,SUM(PERIOD_8)  AS PERIOD_8, SUM(PERIOD_9)  AS PERIOD_9, SUM(PERIOD_10) AS PERIOD_10,(SUM(PERIOD_1)+SUM(PERIOD_2)+SUM(PERIOD_3)+SUM(PERIOD_4)+SUM(PERIOD_5)+SUM(PERIOD_6)+SUM(PERIOD_7)+SUM(PERIOD_8)+SUM(PERIOD_9)+SUM(PERIOD_10)) AS TOTAL,ACCOUNT_NUMBER, BUDGET_CATEGORY,IO_CODE, COST_ELEMENT,SUM(QUANTITY) AS QUANTITY FROM            ( SELECT DISTINCT A1.AWARD_ID, A1.AWARD_NUMBER,  A1.ACCOUNT_NUMBER,  T3.BUDGET_CATEGORY_CODE, A3.DESCRIPTION         AS BUDGET_CATEGORY, T3.INTERNAL_ORDER_CODE AS IO_CODE, A4.DESCRIPTION         AS COST_ELEMENT,  CASE WHEN T3.BUDGET_PERIOD=\'1\' THEN T3.LINE_ITEM_COST  ELSE 0 END AS PERIOD_1, CASE WHEN T3.BUDGET_PERIOD=\'2\' THEN T3.LINE_ITEM_COST  ELSE 0 END AS PERIOD_2, CASE WHEN T3.BUDGET_PERIOD=\'3\' THEN T3.LINE_ITEM_COST ELSE 0 END AS PERIOD_3,   CASE WHEN T3.BUDGET_PERIOD=\'4\' THEN T3.LINE_ITEM_COST   ELSE 0 END AS PERIOD_4,   CASE  WHEN T3.BUDGET_PERIOD=\'5\' THEN T3.LINE_ITEM_COST ELSE 0 END AS PERIOD_5,   CASE  WHEN T3.BUDGET_PERIOD=\'6\' THEN T3.LINE_ITEM_COST   ELSE 0  END AS PERIOD_6,  CASE   WHEN T3.BUDGET_PERIOD=\'7\' THEN T3.LINE_ITEM_COST ELSE 0 END AS PERIOD_7,  CASE WHEN T3.BUDGET_PERIOD=\'8\' THEN T3.LINE_ITEM_COST ELSE 0 END AS PERIOD_8, CASE WHEN T3.BUDGET_PERIOD=\'9\' THEN T3.LINE_ITEM_COST ELSE 0 END AS PERIOD_9, CASE WHEN T3.BUDGET_PERIOD=\'10\' THEN T3.LINE_ITEM_COST ELSE 0  END         AS PERIOD_10, T3.QUANTITY AS QUANTITY FROM            AWARD A1 INNER JOIN      AWARD_BUDGET_HEADER T1 ON              A1.AWARD_ID = T1.AWARD_ID LEFT JOIN       AWARD_EXPENSE_TRANSACTIONS S2 ON              A1.AWARD_NUMBER = S2.AWARD_NUMBER AND A1.ACCOUNT_NUMBER = S2.ACCOUNT_NUMBER INNER JOIN      AWARD_BUDGET_PERIOD T8 ON              T8.BUDGET_HEADER_ID = T1.BUDGET_HEADER_ID INNER JOIN      AWARD_BUDGET_DETAIL T3 ON              T3.BUDGET_HEADER_ID = T1.BUDGET_HEADER_ID INNER JOIN      BUDGET_CATEGORY A3 ON              T3.BUDGET_CATEGORY_CODE = A3.BUDGET_CATEGORY_CODE INNER JOIN      COST_ELEMENT A4 ON              T3.COST_ELEMENT = A4.COST_ELEMENT WHERE           A1.AWARD_SEQUENCE_STATUS = \'ACTIVE\'  <FILTER_CONDITION> AND             T1.VERSION_NUMBER IN(  SELECT MAX(AB1.VERSION_NUMBER) FROM   AWARD_BUDGET_HEADER AB1 WHERE  AB1.AWARD_ID = T1.AWARD_ID AND (AWARD_BUDGET_STATUS_CODE =\'10\' or AWARD_BUDGET_STATUS_CODE=\'9\' ))) AS T1 GROUP BY AWARD_ID,COST_ELEMENT,IO_CODE)CHILD ON MASTER_DATA.AWARD_ID = CHILD.AWARD_ID AND MASTER_DATA.PERSON_ROLE_ID = 3','2022-02-17 07:35:22','willsmith');
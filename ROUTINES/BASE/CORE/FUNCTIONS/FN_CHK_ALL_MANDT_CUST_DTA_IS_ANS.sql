CREATE FUNCTION FN_CHK_ALL_MANDT_CUST_DTA_IS_ANS (
    AV_PROPOSAL_ID VARCHAR(60)
) RETURNS VARCHAR(6)
DETERMINISTIC
BEGIN
    DECLARE LI_MAN_CUSTOM_DATA INT DEFAULT 0;
    DECLARE LI_ANS_CUSTOM_DATA INT DEFAULT 0;

-- Mandatory custom data count.
    SELECT COUNT(1)
    INTO LI_MAN_CUSTOM_DATA
    FROM CUSTOM_DATA_ELEMENT_USAGE
    WHERE MODULE_CODE = 3 AND IS_REQUIRED = 'Y';

-- Mandatory custom data answered count.
    SELECT COUNT(1)
    INTO LI_ANS_CUSTOM_DATA
    FROM CUSTOM_DATA
    WHERE MODULE_ITEM_CODE = 3
      AND MODULE_ITEM_KEY = AV_PROPOSAL_ID
      AND CUSTOM_DATA_ELEMENTS_ID IN (
          SELECT CUSTOM_DATA_ELEMENTS_ID
          FROM CUSTOM_DATA_ELEMENT_USAGE
          WHERE MODULE_CODE = 3 AND IS_REQUIRED = 'Y'
      );

    IF LI_MAN_CUSTOM_DATA = LI_ANS_CUSTOM_DATA THEN
        RETURN 'TRUE';
    ELSE
        RETURN 'FALSE';
    END IF;
END

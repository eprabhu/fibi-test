-- `FN_LEAD_UNIT_BELOW`; 

CREATE FUNCTION `FN_LEAD_UNIT_BELOW`(AV_PROPOSAL_ID INT, AV_UNIT_NUMBER VARCHAR(50)) RETURNS varchar(6) 
    DETERMINISTIC
BEGIN
    DECLARE LI_COUNT  INT;
	SELECT COUNT(*) INTO LI_COUNT FROM eps_proposal WHERE PROPOSAL_ID=AV_PROPOSAL_ID AND HOME_UNIT_NUMBER IN 
    (SELECT CHILD_UNIT_NUMBER FROM unit_with_children WHERE UNIT_NUMBER = AV_UNIT_NUMBER);
    IF (LI_COUNT > 0) THEN
		RETURN 'TRUE';
	ELSE
		RETURN 'FALSE';
	END IF;
END

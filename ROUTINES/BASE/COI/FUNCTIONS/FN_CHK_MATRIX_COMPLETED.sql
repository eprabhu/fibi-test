

CREATE FUNCTION `FN_CHK_MATRIX_COMPLETED`(
AV_PERSON_ENTITY_ID INT
) RETURNS varchar(8) CHARSET utf8mb4
    DETERMINISTIC
BEGIN
DECLARE LI_ANSWER_COUNT INT;
DECLARE LI_QUESTION_COUNT INT;

SELECT COUNT(*) INTO LI_ANSWER_COUNT
	FROM PER_ENT_MATRIX_ANSWER
	WHERE PERSON_ENTITY_ID = AV_PERSON_ENTITY_ID;
    
    SELECT COUNT(*) INTO LI_QUESTION_COUNT 
    FROM PER_ENT_MATRIX_QUESTION;
    
    -- IF LI_ANSWER_COUNT <> (LI_QUESTION_COUNT * 3) THEN
    IF LI_ANSWER_COUNT > 0 THEN
     RETURN 'TRUE';
    END IF;
    
    RETURN 'FALSE';

END

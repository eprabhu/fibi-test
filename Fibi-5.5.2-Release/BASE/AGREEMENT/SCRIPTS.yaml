databaseChangeLog:

  - changeSet:
      id: FIBI-9155-1
      author: Vishnu BH
      labels: 'PROCEDURES'
      comment: Modified GET_AGREEMENT_DASHBOARD_V1 to include data type 6 in custom criteria logic for elastic search
      runOnChange: true
      changes:
        - sql:
            sql: DROP PROCEDURE IF EXISTS GET_AGREEMENT_DASHBOARD_V1;
        - sqlFile:
            path: ROUTINES/BASE/AGREEMENT/PROCEDURES/GET_AGREEMENT_DASHBOARD_V1.sql
            relativeToChangelogFile: false
            splitStatements: false
      rollback: empty

  - changeSet:
      id: FIBI-9134-1
      author: Reshma Antony
      labels: 'DML'
      comment: Insert into DYN_ELEMENT_CONFIG for Agreement Project association.
      changes:
        - sql:
            sql: |
              INSERT INTO DYN_ELEMENT_CONFIG (UI_REFERENCE_ID, DESCRIPTION, SUB_SECTION_CODE, SECTION_CODE, HELP, UPDATE_USER, UPDATE_TIMESTAMP) 
              SELECT 'agrmnt-prj-assoc-module', 'Agreement Project assoc Module', '529', 'AG1303', 'Select the module that most accurately matches the purpose of this record.', 'admin', UTC_TIMESTAMP() 
                WHERE NOT EXISTS (
                    SELECT 1 FROM DYN_ELEMENT_CONFIG WHERE UI_REFERENCE_ID = 'agrmnt-prj-assoc-module');                      
              INSERT INTO DYN_ELEMENT_CONFIG (UI_REFERENCE_ID, DESCRIPTION, SUB_SECTION_CODE, SECTION_CODE, HELP, UPDATE_USER, UPDATE_TIMESTAMP) 
              SELECT 'agrmnt-prj-assoc-relation-type', 'Agreement Project asscoc Relation type', '529', 'AG1303', 'Indicates the relationship between the current record and the selected linked record.', 'admin', UTC_TIMESTAMP()
              WHERE NOT EXISTS (
                  SELECT 1 FROM DYN_ELEMENT_CONFIG WHERE UI_REFERENCE_ID = 'agrmnt-prj-assoc-relation-type'
              );
              INSERT INTO DYN_ELEMENT_CONFIG (UI_REFERENCE_ID, DESCRIPTION, SUB_SECTION_CODE, SECTION_CODE, HELP, UPDATE_USER, UPDATE_TIMESTAMP)
              SELECT 'agrmnt-prj-assoc-link-to', 'Agreement Project asscoc Link to','529', 
                  'AG1303', 'Search for and select the appropriate record to establish the association.', 'admin', UTC_TIMESTAMP()
              WHERE NOT EXISTS (
                  SELECT 1 FROM DYN_ELEMENT_CONFIG WHERE UI_REFERENCE_ID = 'agrmnt-prj-assoc-link-to'
              );
      rollback: 
        - sql:
            sql: |    
              DELETE FROM `DYN_ELEMENT_CONFIG` WHERE UI_REFERENCE_ID = 'agrmnt-prj-assoc-link-to';         
              DELETE FROM `DYN_ELEMENT_CONFIG` WHERE UI_REFERENCE_ID = 'grmnt-prj-assoc-relation-type';
              DELETE FROM `DYN_ELEMENT_CONFIG` WHERE UI_REFERENCE_ID = 'agrmnt-prj-assoc-module';
